<html>
<body>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<div id="sankey_multiple1" style="width: 900px; height: 300px;"></div>




<script type="text/javascript">
    google.charts.load("current", {packages:["sankey"]});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'From');
        data.addColumn('string', 'To');
        data.addColumn('number', 'Weight');
        data.addRows([

            // Dependencies
            [ 'Dependency', 'Declared', 1100 ],
            //[ 'Dependency', 'Discovered', 50 ],


            // Vulnerable status
            [ 'Declared', 'Secure', 875 ],
            [ 'Declared', 'Vulnerable',  225],

            // vulnerability count
            [ 'Vulnerable', 'Vulnerabilities', 463 ],
            [ 'Secure', 'No Action', 875],

            [ 'Vulnerabilities', 'Has Fix', 447],
            [ 'Vulnerabilities', 'No Fix', 16],

            [ 'Has Fix', 'Depth < 2', 84],
            [ 'Depth < 2', 'CVSS3 > Medium', 26],
            [  'CVSS3 > Medium', 'EPSS > 50', 5],


            // source code
            /*[ 'Source Component', 'CDN', 2 ],
            [ 'Source Component', 'Forked Repo', 2],
            [ 'Source Component', 'Script', 2 ],
            [ 'Source Component', 'Embedded', 2 ],
            [ 'CDN', 'Vulnerable', 2 ],
            [ 'Forked Repo', 'Vulnerable', 2 ],
            [ 'Script', 'Vulnerable', 2 ],
            [ 'Embedded', 'Vulnerable', 2 ],*/


        ]);

        // Set chart options
        var options = {
            width: 750,
            sankey: { node: { nodePadding: 20 } },
        };

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.Sankey(document.getElementById('sankey_multiple'));
        chart.draw(data, options);
    }
</script>
<script type="text/javascript">
    google.charts.load("current", {packages:["sankey"]});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'From');
        data.addColumn('string', 'To');
        data.addColumn('number', 'Weight');
        data.addRows([

            // Discovery Type
            [ 'Declared', 'POM', 851 ],
            [ 'Declared', 'Poetry', 433 ],
            [ 'Discovered', 'Library', 246 ],
            [ 'Discovered', 'CDN', 54 ],
            [ 'Discovered', 'Forked Repo', 6],
            [ 'Discovered', 'Script', 115 ],
            [ 'Discovered', 'Embedded', 34],

            // Security Status
            [ 'POM', 'Secure', 673 ],
            [ 'POM', 'Vulnerable', 178 ],

            [ 'Poetry', 'Secure',  331],
            [ 'Poetry', 'Vulnerable',  112],

            [ 'Library', 'Secure',  202],
            [ 'Library', 'Vulnerable',  42],

            [ 'CDN', 'Secure',  47],
            [ 'CDN', 'Vulnerable',  7],

            [ 'Forked Repo', 'Secure', 4 ],
            [ 'Forked Repo', 'Vulnerable', 2],

            [ 'Script', 'Secure', 86 ],
            [ 'Script', 'Vulnerable', 29],

            [ 'Embedded', 'Secure', 33 ],
            [ 'Embedded', 'Vulnerable', 1],

            // vulnerability count
            [ 'Vulnerable', 'Vulnerabilities', 581 ],
            //[ 'Secure', 'No Action', 1375],

            [ 'Vulnerabilities', 'Has Fix', 567],
            [ 'Vulnerabilities', 'No Fix', 14],

            [ 'Has Fix', 'Depth < 2', 84],
            [ 'Depth < 2', 'CVSS3 > Medium', 26],
            [  'CVSS3 > Medium', 'EPSS > 50', 12],




            // source code
            /*[ 'Source Component', 'CDN', 2 ],
            [ 'Source Component', 'Forked Repo', 2],
            [ 'Source Component', 'Script', 2 ],
            [ 'Source Component', 'Embedded', 2 ],
            [ 'CDN', 'Vulnerable', 2 ],
            [ 'Forked Repo', 'Vulnerable', 2 ],
            [ 'Script', 'Vulnerable', 2 ],
            [ 'Embedded', 'Vulnerable', 2 ],*/


        ]);

        // Set chart options
        var options = {
            width: 750,
           // sankey: { node: { nodePadding: 20 } },
        };

        /*var colors = ['#a6cee3', '#b2df8a', '#fb9a99', '#fdbf6f',
                  '#cab2d6', '#ffff99', '#1f78b4', '#33a02c'];

        var options = {
            height: 400,
            sankey: {
                node: {
                    colors: colors
                },
                link: {
                    colorMode: 'gradient',
                    colors: colors
                }
            }
        };*/

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.Sankey(document.getElementById('sankey_multiple1'));
        chart.draw(data, options);
    }
</script>

</body>
</html>
